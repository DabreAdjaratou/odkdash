<?php
//\Zend\Debug\Debug::dump($perflast30);die;
?>
<div class="row chart-container">
                  <div class="col-md-6">
		    <canvas id="widget-top-2" style="width: 100%; height: 170px;"></canvas>
                  </div>
                  <div class="col-md-6">
                    <div class="legend" id="legend30"></div>
                  </div>
                </div>
		  <div class="row chart-info">
		    <div class="col-xs-4" style="text-align:center;"><span class="title">From Date</span><span class="number"><?php echo $this->humanDateFormat($perflast30[0]['oldestDate']) ?></span></div>
		    <div class="col-xs-4" style="text-align:center;padding-left:5px;"><span class="title">To Date</span><span class="number"><?php echo $this->humanDateFormat($perflast30[0]['newestDate']) ?></span></div>
		    <div class="col-xs-4" style="text-align:center;"><span class="title">No. of Audits</span><span class="number"><?php echo $perflast30[0]['totalDataPoints']; ?></span></div>
                </div>
<script type="text/javascript">
      
		var color1 = "red";
		var color2 = "orange";
		var color3 = "yellow";
		var color4 = "#8DD63E";
		var color5 = "#528A16";

		//Get the template css colors into js vars
		function getColor( c ){
		  var tmp = $("<div>", { class: c }).appendTo("body");
		  var color = tmp.css("background-color");
		  tmp.remove();
	  
		  return color;
		}
  
		var colors = {};
		colors.primary = getColor('clr-primary');
        colors.success = getColor('clr-success');
        colors.info    = getColor('clr-info');
        colors.warning = getColor('clr-warning');
        colors.danger  = getColor('clr-danger');
        colors.alt1    = getColor('clr-alt1');
        colors.alt2    = getColor('clr-alt2');
        colors.alt3    = getColor('clr-alt3');
        colors.alt4    = getColor('clr-alt4');
function widget_top_2(){
    
		<?php
		
			$perflast30[0]['level0'] = ($perflast30[0]['level0'] > 0) ? $perflast30[0]['level0'] : 0;
			$perflast30[0]['level1'] = ($perflast30[0]['level1'] > 0) ? $perflast30[0]['level1'] : 0;
			$perflast30[0]['level2'] = ($perflast30[0]['level2'] > 0) ? $perflast30[0]['level2'] : 0;
			$perflast30[0]['level3'] = ($perflast30[0]['level3'] > 0) ? $perflast30[0]['level3'] : 0;
			$perflast30[0]['level4'] = ($perflast30[0]['level4'] > 0) ? $perflast30[0]['level4'] : 0;
			
	  	?>
			
	  var data = [
		 {
		  value: <?php echo $perflast30[0]['level0']; ?>,
		  color: color1,
		  label: "Level 0 (Below 40)"
	  },
		 {
		  value: <?php echo $perflast30[0]['level1']; ?>,
		  color: color2,
		  label: "Level 1 (40-59)"
	  },
		 {
		  value: <?php echo $perflast30[0]['level2']; ?>,
		  color: color3,
		  label: "Level 2 (60-79)"
	  },
		 {
		  value: <?php echo $perflast30[0]['level3']; ?>,
		  color: color4,
		  label: "Level 3 (80-89)"
	  },
		 {
		  value: <?php echo $perflast30[0]['level4']; ?>,
		  color: color5,
		  label: "Level 4 (90 and above)"
	  },
	  
	  
	  ];
	  
	  var options = {
		  segmentShowStroke: false,
		  animationSteps : 20,
		  animateRotate: true,
		  animateScale: false,
		  percentageInnerCutout: 50,
		  tooltipTemplate: "<%= value %>",
		  legendTemplate : '<table style="font-size:smaller;color:#545454"><tbody><tr><td class="legendColorBox"><div style="border:1px solid #ccc;padding:1px"><div style="width:4px;height:0;border:5px solid rgb(255,0,0);overflow:hidden"></div></div></td><td class="legendLabel">Level 0 (Below 40)</td></tr><tr><td class="legendColorBox"><div style="border:1px solid #ccc;padding:1px"><div style="width:4px;height:0;border:5px solid rgb(255,165,0);overflow:hidden"></div></div></td><td class="legendLabel">Level 1 (40-59)</td></tr><tr><td class="legendColorBox"><div style="border:1px solid #ccc;padding:1px"><div style="width:4px;height:0;border:5px solid rgb(255,255,0);overflow:hidden"></div></div></td><td class="legendLabel">Level 2 (60-79)</td></tr><tr><td class="legendColorBox"><div style="border:1px solid #ccc;padding:1px"><div style="width:4px;height:0;border:5px solid rgb(141,214,62);overflow:hidden"></div></div></td><td class="legendLabel">Level 3 (80-89)</td></tr><tr><td class="legendColorBox"><div style="border:1px solid #ccc;padding:1px"><div style="width:4px;height:0;border:5px solid rgb(82,138,22);overflow:hidden"></div></div></td><td class="legendLabel">Level 4 (90 and above)</td></tr></tbody></table>'
	  }
	  
	  var ctx = document.getElementById("widget-top-2").getContext("2d");
	  
	  var myChart = new Chart(ctx).Doughnut(data, options);
	  
	  
	  document.getElementById('legend30').innerHTML = myChart.generateLegend();	  
	  
	  
    }
    $(document).ready(function(){
        widget_top_2();
    });
    
</script>